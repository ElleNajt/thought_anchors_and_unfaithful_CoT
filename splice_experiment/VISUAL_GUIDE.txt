╔══════════════════════════════════════════════════════════════════════════════╗
║                        SPLICE EXPERIMENT VISUAL GUIDE                        ║
╚══════════════════════════════════════════════════════════════════════════════╝

┌──────────────────────────────────────────────────────────────────────────────┐
│  THE PROBLEM: High-Delta Sentences                                           │
└──────────────────────────────────────────────────────────────────────────────┘

We observed sentences that cause HUGE jumps in P(hinted answer):

    Problem 3, Sentence 0:  cue_p: 0.00 → 0.82  (Δ = 0.82 ⬆️)
    Problem 288, Sentence 11: cue_p: 0.14 → 0.96  (Δ = 0.82 ⬆️)
    Problem 59, Sentence 4:  cue_p: 0.24 → 1.00  (Δ = 0.76 ⬆️)

Question: Are these sentences CAUSING the anchoring, or just CORRELATED with it?

┌──────────────────────────────────────────────────────────────────────────────┐
│  THE INTERVENTION: Splice at High-Delta Sentences                            │
└──────────────────────────────────────────────────────────────────────────────┘

ORIGINAL HINTED CoT:
┌────────────────────────────────────────────────────────────────────────────┐
│ [Sent 0] [Sent 1] ... [HIGH DELTA SENT] [Sent N+1] ... → Answer: H       │
│                              ▲                                              │
│                              │ Delta = 0.82                                 │
│                       P(H) jumps here!                                      │
│                                                                              │
│ Distribution: P(H) = 0.85, P(others) = 0.15                                │
└────────────────────────────────────────────────────────────────────────────┘

ORIGINAL UNHINTED CoT:
┌────────────────────────────────────────────────────────────────────────────┐
│ [Different reasoning] ... → Answer: varies                                 │
│                                                                              │
│ Distribution: P(H) = 0.25, P(others) = 0.75                                │
└────────────────────────────────────────────────────────────────────────────┘

SPLICED CoT (OUR EXPERIMENT):
┌────────────────────────────────────────────────────────────────────────────┐
│ [Sent 0] [Sent 1] ... │ ← SPLICE HERE                                      │
│   (hinted prefix)     │                                                     │
│                       ↓                                                     │
│              [UNHINTED CONTINUATION...] → Answer: ?                        │
│                 (sampled fresh)                                             │
│                                                                              │
│ Distribution: P(H) = ??? (this is what we measure)                         │
└────────────────────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────────────────────────┐
│  EXPECTED OUTCOMES                                                            │
└──────────────────────────────────────────────────────────────────────────────┘

Hypothesis H1: High-delta sentences ARE anchors (causal)
┌────────────────────────────────────────────────────────────────────────────┐
│ SPLICED distribution should shift AWAY from hinted answer:                 │
│                                                                              │
│    P(H | hinted)   = 0.85  ──┐                                             │
│    P(H | splice)   = 0.35  ──┼─→ DROP = 0.50  ✓                           │
│    P(H | unhinted) = 0.25  ──┘                                             │
│                                                                              │
│ Splice is CLOSER to unhinted than to hinted                                │
└────────────────────────────────────────────────────────────────────────────┘

Hypothesis H0: High-delta sentences are NOT anchors (just correlated)
┌────────────────────────────────────────────────────────────────────────────┐
│ SPLICED distribution stays SIMILAR to hinted:                              │
│                                                                              │
│    P(H | hinted)   = 0.85  ──┐                                             │
│    P(H | splice)   = 0.80  ──┼─→ DROP = 0.05  ✗                           │
│    P(H | unhinted) = 0.25  ──┘                                             │
│                                                                              │
│ Splice is CLOSER to hinted than to unhinted                                │
└────────────────────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────────────────────────┐
│  EXPERIMENT FLOW                                                              │
└──────────────────────────────────────────────────────────────────────────────┘

INPUT DATA:
    per_problem_timeseries_with_sentences_all34_delta_analysis.csv
    ├─ problem_number, sentence_number, delta_cue_p, sentence
    └─ Identifies high-delta sentences

    cot_responses.json (from original experiment)
    ├─ hinted_samples (CoTs to splice)
    └─ hinted_distribution, unhinted_distribution (for comparison)

         ↓

STEP 1: run_splice_experiment.py
    ├─ Load high-delta sentences (delta > threshold)
    ├─ For each sentence:
    │   ├─ Extract hinted prefix (up to but not including sentence)
    │   ├─ Sample N unhinted continuations
    │   └─ Record answer distributions
    └─ Save to results/TIMESTAMP/splice_results.json

         ↓

STEP 2: analyze_results.py
    ├─ Load splice results
    ├─ Compare to original hinted/unhinted distributions
    ├─ Compute metrics:
    │   ├─ drop_from_hinted
    │   ├─ shift_from_unhinted
    │   └─ closer_to (hinted vs unhinted)
    └─ Generate visualizations

         ↓

OUTPUT:
    results/TIMESTAMP/
    ├─ splice_results.json (raw data)
    ├─ summary.json (aggregate stats)
    └─ visualizations/
        ├─ statistics.csv
        ├─ delta_vs_drop_scatter.png
        ├─ probability_comparison_bars.png
        └─ problem_*_distribution.png

┌──────────────────────────────────────────────────────────────────────────────┐
│  KEY METRICS VISUALIZED                                                       │
└──────────────────────────────────────────────────────────────────────────────┘

1. Delta vs Drop Scatter Plot:
   
   Drop from Hinted │
       0.8          │         ●
       0.6          │      ●    ●
       0.4          │   ●    ●
       0.2          │ ●
       0.0          ├─────────────────
                       0.4  0.6  0.8
                       Delta cue_p

   Strong positive correlation → H1 supported

2. Probability Comparison:
   
   P(hinted) │
       1.0   │ ███
       0.8   │ ███  ▒▒▒
       0.6   │ ███  ▒▒▒
       0.4   │ ███  ▒▒▒  ░░░
       0.2   │ ███  ▒▒▒  ░░░
       0.0   └─────────────────
               Orig  Splice Orig
               Hinted        Unhinted

   Splice closer to Unhinted → H1 supported

┌──────────────────────────────────────────────────────────────────────────────┐
│  INTERPRETATION GUIDE                                                         │
└──────────────────────────────────────────────────────────────────────────────┘

Strong Evidence for H1 (Anchors are CAUSAL):
  ✓ Average drop_from_hinted > 0.15
  ✓ >70% of splices closer to "unhinted"
  ✓ Strong correlation (r > 0.5) between delta and drop
  ✓ Visual shift in distributions

Weak/No Evidence (Anchors are NOT causal):
  ✗ Average drop_from_hinted < 0.05
  ✗ <50% of splices closer to "unhinted"
  ✗ No correlation between delta and drop
  ✗ Spliced distributions similar to hinted originals

┌──────────────────────────────────────────────────────────────────────────────┐
│  EXAMPLE: Problem 288, Sentence 11                                           │
└──────────────────────────────────────────────────────────────────────────────┘

High-delta sentence (Δ = 0.82):
  "So the negotiation part is something the president can do on their own,
   which might fall under inherent powers..."

Before this sentence: P(hinted answer D) = 0.14
After this sentence:  P(hinted answer D) = 0.96

EXPERIMENT:
  Prefix: [First 10 sentences of hinted reasoning]
  Splice: [Sample unhinted continuation from here]
  Result: P(D | splice) = ???

If P(D | splice) ≈ 0.35 (between 0.14 and 0.96, closer to unhinted):
  → This sentence WAS a causal anchor!

If P(D | splice) ≈ 0.90 (still close to 0.96):
  → This sentence was NOT the anchor (or prefix already locked it in)

╔══════════════════════════════════════════════════════════════════════════════╗
║  Ready to run? Start with:  python test_setup.py                            ║
║  Then:                       ./run_example.sh                                ║
╚══════════════════════════════════════════════════════════════════════════════╝

